<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PitchPerfect - AI Proposal Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Import html2pdf library for exporting PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  </head>

  <body class="bg-gray-100 font-sans">
    <div class="max-w-3xl mx-auto p-6">
      <!-- Header -->
      <header class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800">üöÄ PitchPerfect</h1>
        <p class="text-lg text-gray-600 mt-2">
          AI-Powered Proposal Generator for Freelancers
        </p>
      </header>

      <!-- Form Section -->
      <form id="proposalForm" class="space-y-4">
        <div>
          <label class="block font-medium text-gray-700">Your Name</label>
          <input
            type="text"
            id="name"
            class="w-full border border-gray-300 rounded p-2"
            placeholder="e.g. Ali Raza"
          />
        </div>

        <div>
          <label class="block font-medium text-gray-700">Your Skills</label>
          <input
            type="text"
            id="skills"
            class="w-full border border-gray-300 rounded p-2"
            placeholder="e.g. Web Development, React, UI Design"
          />
        </div>

        <div>
          <label class="block font-medium text-gray-700">Platform</label>
          <select
            id="platform"
            class="w-full border border-gray-300 rounded p-2"
          >
            <option value="Upwork">Upwork</option>
            <option value="Fiverr">Fiverr</option>
            <option value="Freelancer">Freelancer</option>
          </select>
        </div>

        <div>
          <label class="block font-medium text-gray-700">Tone</label>
          <select id="tone" class="w-full border border-gray-300 rounded p-2">
            <option value="Friendly">Friendly</option>
            <option value="Professional">Professional</option>
            <option value="Confident">Confident</option>
          </select>
        </div>

        <div>
          <label class="block font-medium text-gray-700">Job Description</label>
          <textarea
            id="job"
            rows="6"
            class="w-full border border-gray-300 rounded p-2"
            placeholder="Paste the job post or project description here..."
          ></textarea>
        </div>

        <div class="text-center">
          <button
            type="submit"
            class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition"
          >
            ‚ö° Generate Proposal
          </button>
        </div>
      </form>

      <!-- Output Section -->
      <section id="outputSection" class="mt-10 hidden">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">
          üß† Generated Proposal:
        </h2>
        <div
          id="proposalResult"
          class="whitespace-pre-line bg-white border border-gray-300 rounded p-4 text-gray-800 shadow"
        ></div>

        <div class="flex justify-end mt-4 space-x-4">
          <button
            id="copyBtn"
            class="bg-gray-200 px-4 py-2 rounded hover:bg-gray-300"
          >
            üìã Copy
          </button>
          <button
            id="exportBtn"
            class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600"
          >
            ‚¨áÔ∏è Export PDF
          </button>
        </div>
      </section>
    </div>

    <script>
      // Handle form submission
      document
        .getElementById("proposalForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const name = document.getElementById("name").value;
          const skills = document.getElementById("skills").value;
          const platform = document.getElementById("platform").value;
          const tone = document.getElementById("tone").value;
          const job = document.getElementById("job").value;

          const response = await fetch("http://127.0.0.1:5000/generate", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, skills, platform, tone, job }),
          });

          const result = await response.json();

          if (result.proposal) {
            document.getElementById("proposalResult").innerText =
              result.proposal;
            document.getElementById("outputSection").classList.remove("hidden");
          } else {
            alert(
              "‚ùå Failed to generate proposal: " +
                (result.error || "Unknown error")
            );
          }
        });

      // Copy to clipboard
      document.getElementById("copyBtn").addEventListener("click", function () {
        const text = document.getElementById("proposalResult").innerText;
        navigator.clipboard.writeText(text).then(
          () => alert("‚úÖ Proposal copied!"),
          () => alert("‚ùå Copy failed!")
        );
      });

      // Export to PDF
      document
        .getElementById("exportBtn")
        .addEventListener("click", function () {
          const element = document.getElementById("proposalResult");
          const opt = {
            margin: 0.5,
            filename: "proposal.pdf",
            image: { type: "jpeg", quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: "in", format: "letter", orientation: "portrait" },
          };
          html2pdf().from(element).set(opt).save();
        });
    </script>
  </body>
</html>
